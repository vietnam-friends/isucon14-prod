# ISUCON分析レポート

生成日時: Mon Aug 25 20:08:26 UTC 2025
ホスト: ip-172-31-44-203

## システム情報

- OS: Linux 6.14.0-1010-aws
- CPU: 2 cores
- メモリ: 3.7Gi
- ディスク: 15G (62% used)

## スロークエリ分析結果

```
  COMMIT

Count: 1780  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), 0users@0hosts
  administrator command: Quit

Count: 1758  Time=0.02s (43s)  Lock=0.00s (0s)  Rows=1.0 (1758), isucon[isucon]@localhost
  SELECT status FROM ride_statuses WHERE ride_id = 'S' ORDER BY created_at DESC LIMIT N


=== 平均実行時間順上位10件 ===
Count: 6  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  INSERT INTO rides (id, user_id, pickup_latitude, pickup_longitude, destination_latitude, destination_longitude)
  VALUES ('S', 'S', N, N, N, N)

Count: 1  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  LOCK TABLES `chair_locations` WRITE

Count: 20  Time=0.01s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  INSERT INTO chairs (id, owner_id, name, model, is_active, access_token) VALUES ('S', 'S', 'S', 'S', N, 'S')

Count: 118  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.1 (10), isucon[isucon]@localhost
  SELECT * FROM rides WHERE chair_id IS NULL ORDER BY created_at LIMIT N

Count: 10  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  INSERT INTO coupons (user_id, code, discount) VALUES ('S', 'S', N)

Count: 21  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=1.0 (21), isucon[isucon]@localhost
  SELECT * FROM chairs INNER JOIN (SELECT id FROM chairs WHERE is_active = TRUE ORDER BY RAND() LIMIT N) AS tmp ON chairs.id = tmp.id LIMIT N

Count: 1  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
```

詳細: analysis_20250825_200740.txt

## alp分析結果

```
+-------+-----+------+-----+-----+-----+--------+-------------------------------+-------+-------+---------+-------+-------+-------+-------+--------+-----------+-----------+------------+-----------+

=== P99レスポンス時間順（上位30件） ===
+-------+-----+------+-----+-----+-----+--------+-------------------------------+-------+-------+---------+-------+-------+-------+-------+-------+--------+-----------+-----------+------------+-----------+
| COUNT | 1XX | 2XX  | 3XX | 4XX | 5XX | METHOD |              URI              |  MIN  |  MAX  |   SUM   |  AVG  |  P50  |  P90  |  P95  |  P99  | STDDEV | MIN(BODY) | MAX(BODY) | SUM(BODY)  | AVG(BODY) |
+-------+-----+------+-----+-----+-----+--------+-------------------------------+-------+-------+---------+-------+-------+-------+-------+-------+--------+-----------+-----------+------------+-----------+
| 13    | 0   | 13   | 0   | 0   | 0   | GET    | /api/app/nearby-chairs        | 3.299 | 4.075 | 49.189  | 3.784 | 3.818 | 4.052 | 4.075 | 4.075 | 0.212  | 42.000    | 882.000   | 4160.000   | 320.000   |
| 24    | 0   | 24   | 0   | 0   | 0   | GET    | /api/owner/chairs             | 0.162 | 3.650 | 71.332  | 2.972 | 3.137 | 3.571 | 3.627 | 3.650 | 0.699  | 728.000   | 19007.000 | 36794.000  | 1533.083  |
| 1     | 0   | 1    | 0   | 0   | 0   | POST   | /api/initialize               | 1.778 | 1.778 | 1.778   | 1.778 | 1.778 | 1.778 | 1.778 | 1.778 | 0.000  | 17.000    | 17.000    | 17.000     | 17.000    |
| 618   | 0   | 612  | 0   | 6   | 0   | GET    | /api/app/notification         | 0.024 | 0.484 | 139.852 | 0.226 | 0.202 | 0.359 | 0.384 | 0.439 | 0.083  | 0.000     | 428.000   | 236329.000 | 382.409   |
| 489   | 0   | 489  | 0   | 0   | 0   | POST   | /api/chair/coordinate         | 0.052 | 0.384 | 79.386  | 0.162 | 0.160 | 0.231 | 0.246 | 0.292 | 0.048  | 29.000    | 29.000    | 14181.000  | 29.000    |
| 4061  | 0   | 4048 | 0   | 13  | 0   | GET    | /api/chair/notification       | 0.007 | 0.338 | 288.912 | 0.071 | 0.051 | 0.146 | 0.195 | 0.269 | 0.054  | 0.000     | 266.000   | 296928.000 | 73.117    |
| 25    | 0   | 25   | 0   | 0   | 0   | POST   | /api/app/rides                | 0.001 | 0.219 | 2.029   | 0.081 | 0.055 | 0.180 | 0.197 | 0.219 | 0.067  | 26.000    | 52.000    | 943.000    | 37.720    |
| 2     | 0   | 2    | 0   | 0   | 0   | GET    | /api/owner/sales              | 0.131 | 0.187 | 0.318   | 0.159 | 0.131 | 0.187 | 0.187 | 0.187 | 0.028  | 9017.000  | 9183.000  | 18200.000  | 9100.000  |
| 13    | 0   | 13   | 0   | 0   | 0   | POST   | /api/chair/rides/[^/]+/status | 0.037 | 0.159 | 1.125   | 0.087 | 0.077 | 0.125 | 0.159 | 0.159 | 0.032  | 0.000     | 0.000     | 0.000      | 0.000     |
| 16    | 0   | 16   | 0   | 0   | 0   | GET    | /api/app/rides                | 0.002 | 0.071 | 0.711   | 0.044 | 0.050 | 0.068 | 0.071 | 0.071 | 0.020  | 12.000    | 2158.000  | 4090.000   | 255.625   |
| 10    | 0   | 10   | 0   | 0   | 0   | POST   | /api/app/payment-methods      | 0.034 | 0.055 | 0.514   | 0.051 | 0.054 | 0.055 | 0.055 | 0.055 | 0.007  | 0.000     | 0.000     | 0.000      | 0.000     |
| 20    | 0   | 20   | 0   | 0   | 0   | POST   | /api/chair/activity           | 0.031 | 0.055 | 0.789   | 0.039 | 0.036 | 0.055 | 0.055 | 0.055 | 0.009  | 0.000     | 0.000     | 0.000      | 0.000     |
| 10    | 0   | 10   | 0   | 0   | 0   | POST   | /api/app/users                | 0.006 | 0.010 | 0.070   | 0.007 | 0.007 | 0.008 | 0.010 | 0.010 | 0.001  | 86.000    | 86.000    | 860.000    | 86.000    |
| 20    | 0   | 20   | 0   | 0   | 0   | POST   | /api/chair/chairs             | 0.006 | 0.009 | 0.140   | 0.007 | 0.007 | 0.009 | 0.009 | 0.009 | 0.001  | 75.000    | 75.000    | 1500.000   | 75.000    |
| 5     | 0   | 5    | 0   | 0   | 0   | POST   | /api/owner/owners             | 0.006 | 0.007 | 0.032   | 0.006 | 0.006 | 0.007 | 0.007 | 0.007 | 0.000  | 125.000   | 125.000   | 625.000    | 125.000   |
+-------+-----+------+-----+-----+-----+--------+-------------------------------+-------+-------+---------+-------+-------+-------+-------+-------+--------+-----------+-----------+------------+-----------+

=== 詳細統計情報 ===
# リクエスト数分布（上位10パス）
   4061 /api/chair/notification
    618 /api/app/notification
    489 /api/chair/coordinate
     26 /api/app/rides
     24 /api/owner/chairs
```

詳細: alp_analysis_20250825_200744.txt

## pprof分析結果

分析結果が見つかりません

## パフォーマンスサマリー

- 総スロークエリ数: 67964
- 総リクエスト数: 5327

## 改善提案

- **データベース**: スロークエリが67964件検出されました。インデックスの追加を検討してください

---
Generated by ISUCON Toolkit
